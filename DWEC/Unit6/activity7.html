<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DNI</title>
  </head>
  <body>
    <script>
      // The constructor of the DNI's
      // we enter the numbers and the letter
      function DNI(numbers, letter) {
        this.numbers = numbers;
        this.letter = letter;
        // this.mostrarDNI = () => `${this.numbers}${this.letter}`;
        this.rest = parseInt(this.numbers) % 23; //makes the rest of the division of the numbers and 23
        this.getRest = () => {
          return this.rest;
        };
        this.letterMap = new Map()
          .set(0, "T")
          .set(1, "R")
          .set(2, "W")
          .set(3, "A")
          .set(4, "G")
          .set(5, "M")
          .set(6, "Y")
          .set(7, "F")
          .set(8, "P")
          .set(9, "D")
          .set(10, "X")
          .set(11, "B")
          .set(12, "N")
          .set(13, "J")
          .set(14, "Z")
          .set(15, "S")
          .set(16, "Q")
          .set(17, "V")
          .set(18, "H")
          .set(19, "L")
          .set(20, "C")
          .set(21, "K")
          .set(22, "E");
          //This map asigns a letter to a number, to make the assignation of the DNI's correct letter
        this.letterValid = () => {
          if (this.letter === this.letterMap.get(this.getRest())) {
            return `The DNI is correct<br> ${this.numbers}${this.letterMap.get(
              this.getRest())}`;
          } else {
            return `The DNI is not correct<br>DNI introduced: ${this.numbers}${
              this.letter
            }<br>Correct letter of that DNI: ${this.letterMap.get(
              this.getRest())}`;
          }
        };
        //this function returns a sentence if the rest matches the letter introduced or not
      }
      let dni;
      let dniValidate = /([0-9]{8}([A-H]{1}|[J-N]{1}|[P-Z]{1}))/;
      //the regular expression who validates the DNI's structure
      //accepts 8 numbers and only 1 letter between A-H, J-N or P-Z.
      
      do {
        dni = prompt("Introduce your DNI").toUpperCase();
      } while (!dniValidate.test(dni) || dni.length !== 9);
      //Keeps asking if you don't fit that regular expression
      let numbers = "";

      for (let i = 0; i < 8; i++) {
        numbers += dni[i] + "";
      }
      //puts all the numbers alone and creates the new object DNI
      let d = new DNI(numbers, dni[8]);
      document.write(d.letterValid());
      //prints if the method which validates if is correct or not.
    </script>
  </body>
</html>
